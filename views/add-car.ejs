<%- include('partials/header', { title: 'Adaugă Mașină' }) %>
<div class="container mt-5">
    <div class="row justify-content-center">
        <div class="col-md-6 card shadow p-4 border-0">
            <h2 class="text-center mb-4">Adaugă Mașină</h2>
            <% if(typeof error !== 'undefined' && error) { %><div class="alert alert-danger"><%= error %></div><% } %>
            
            <form action="/add-car" method="POST" enctype="multipart/form-data">
                <div class="mb-3">
                    <label class="fw-bold">Număr Înmatriculare</label>
                    <div class="input-group">
                        <span class="input-group-text fw-bold">MD</span>
                        <input type="text" name="plateNumber" id="plateNumber" class="form-control form-control-lg" placeholder="ABC123" maxlength="6" required>
                    </div>
                </div>
                <div class="mb-3">
                    <label class="fw-bold">Marca</label>
                    <select name="make" id="make" class="form-select" required>
                        <option value="" disabled selected>Selectează...</option>
                        <option value="Audi">Audi</option><option value="BMW">BMW</option><option value="Mercedes">Mercedes</option><option value="Toyota">Toyota</option>
                    </select>
                </div>
                <div class="mb-3">
                    <label class="fw-bold">Model</label>
                    <select name="model" id="model" class="form-select" required></select>
                </div>
                <div class="mb-4">
                    <label class="fw-bold">Imagini (Max 3)</label>
                    <input type="file" name="carImage" class="form-control" accept="image/*" multiple required>
                </div>
                <button type="submit" class="btn btn-primary w-100 py-2">SALVEAZĂ</button>
            </form>
        </div>
    </div>
</div>

<script>
    const p = document.getElementById('plateNumber');
    p.addEventListener('input', function() { this.value = this.value.toUpperCase().replace(/[^A-Z0-9]/g, ''); });

    const mSelect = document.getElementById('make');
    const modSelect = document.getElementById('model');
    const data = { "Audi": ["A4", "A6"], "BMW": ["X5", "M3"], "Mercedes": ["E-Class", "S-Class"], "Toyota": ["Corolla", "RAV4"] };

    mSelect.addEventListener('change', () => {
        modSelect.innerHTML = (data[mSelect.value] || []).map(m => `<option value="${m}">${m}</option>`).join('');
    });
</script>
<%- include('partials/footer') %>